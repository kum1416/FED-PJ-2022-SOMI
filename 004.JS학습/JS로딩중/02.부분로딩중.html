<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>02. ë¶€ë¶„ë¡œë”©ì¤‘</title>
        <style>
            /* ë¡œë”©ì¤‘ ì´ë¯¸ì§€ */
            .loading {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 15%;
            }

            /* í™”ë©´ì— ë„£ì„ ì´ë¯¸ì§€ */
            .timg {
                width: 100%;
            }

            /* ê°œë³„ë°•ìŠ¤ */
            .mybx{
                position: relative;
                width: 50vw;
                height: 20vh;
                border: 4px double darkblue;
                overflow: auto;
                /* ì»¨í…ì¸  ì˜¤ë²„ì‹œ ì„¸ë¡œìŠ¤í¬ë¡¤ë°” ìë™ìƒì„± */
                margin: 0 auto;
            }
        </style>
        <script>
            // bodyì— ë„£ì„ ì´ë¯¸ì§€ ì£¼ì†Œ
            const isrc = [
                "https://img.freepik.com/free-vector/night-ocean-landscape-full-moon-stars-shine_107791-7397.jpg?w=2000",
                "https://marketplace.canva.com/EAE-xnqWvJk/1/0/1600w/canva-retro-smoke-and-round-light-desktop-wallpapers-JLofAI27pCg.jpg",
                "https://images3.alphacoders.com/131/1311991.jpeg",
                "https://www.grafico.com.au/assets/uploads/MelbourneMap.jpg",
            ];

            /******************************************* 
                [ ë¡œë”©ì¤‘ í‘œì‹œëŠ” ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ”ê°€? ]
                - ë¡œë“œì´ë²¤íŠ¸ ì¢…ë¥˜ì— ë”°ë¼ ì•„ë˜ 2ê°€ì§€ê°€ ìˆë‹¤
                1. DOMContentLoaded 
                - htmlíƒœê·¸ë§Œ ëª¨ë‘ ê·¸ë ¤ì§€ë©´ ë°œìƒí•¨
                2. load 
                - ëŒ€ìƒë‚´ë¶€ì— ì´ë¯¸ ë„£ì€ íƒœê·¸ì˜ ì»¨í…ì¸ ê°€ 
                ëª¨ë‘ ë¡œë”©ë˜ë©´ ë°œìƒ(ì´ë¯¸ì§€ë‚´ìš©, ë™ì˜ìƒë‚´ìš© ë“± í¬í•¨)

                -> ìœ„ì˜ ê°œë…ì„ ë³¼ë•Œ loadì´ë²¤íŠ¸ êµ¬ì—­ì„ ì‚¬ìš©
                í•´ì•¼ í• ê²ƒ ê°™ìœ¼ë‚˜... JSë¡œ ë§Œë“¤ì–´ì„œ ë™ì ìœ¼ë¡œ
                ìƒì„±í•˜ëŠ” íƒœê·¸ìš”ì†Œë¥¼ ëª¨ë‘ ë¡œë”©í• ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼í•¨!
                ê·¸ëŸ¬ë‚˜ ì¼ë°˜ loadì´ë²¤íŠ¸ëŠ” ì´ê²ƒì„ ì²´í¬ëª»í•¨!

                promiseë¥¼ ì‚¬ìš©í•´ì•¼í•¨!!!
                promiseêµ¬ì—­ì— íƒœê·¸ë¡œë“œ ì½”ë“œë¥¼ ë„£ì–´ì„œ
                ê¸°ë‹¤ë¦¬ê²Œ í•œí›„ ë¡œë”©ë˜ë©´ ë‹¤ìŒì„ ì‹¤í–‰í•¨!

                [ ë¡œë”©ì¤‘ í‘œì‹œëŠ” ì–´ë–»ê²Œí•˜ë‚˜? ]
                1. íƒœê·¸ë¥¼ ë„£ê¸°ì „ ë¡œë”©ì¤‘ ì´ë¯¸ì§€(ë°”)ë¥¼ ë¨¼ì €ì‹¤í–‰
                2. íƒœê·¸ë„£ê¸° í•¨ìˆ˜ ì‹¤í–‰(promiseì•ˆì— ìœ„ì¹˜)
                3. ë¡œë”©í›„ promise then ë˜ëŠ” async/await ë¥¼
                ì‚¬ìš©í•œ ë¡œë”©ì¤‘ ì´ë¯¸ì§€ ì—†ì• ê¸° ì‹¤í–‰

            *******************************************/

            // ì´ë²¤íŠ¸ ë°œìƒ í™•ì¸í•˜ê¸°
            // JSì‹¤í–‰êµ¬ì—­->DOMContentLoaded->load
            window.addEventListener("DOMContentLoaded", () => {
                // bodyê°€ ë¡œë”©ë˜ë©´ ì²´í¬
                document.body.onload = () => {
                    console.log("bodyë¡œë”©ì™„ë£Œ!");
                }; //////////// load /////////////

                // ë¡œë”©ì¤‘ ì´ë¯¸ì§€ ë„£ê¸°í•¨ìˆ˜
                document.querySelectorAll(".mybx")
                .forEach(v=>{
                    v.innerHTML += 
                    `<img class="loading" 
                    src="images/loading_img.gif" alt="ë¡œë”©ì¤‘">`;
                }) ////////// ë¡œë”©ì¤‘ì´ë¯¸ì§€ ëª¨ë‘ ë„£ê¸° ///////////


                // í˜ì´ì§€ì— ë§ì€ ì–‘ì˜ ì´ë¯¸ì§€ ë„£ê¸° í•¨ìˆ˜
                const addImg = (num,seq) => { 
                    // num - ë°˜ë³µê°œìˆ˜, seq - í•´ë‹¹ìš”ì†Œìˆœë²ˆ
                    // numê°œìˆ˜ ë§Œí¼ ë°˜ë³µí•˜ì—¬ ì´ë¯¸ì§€ ë„£ê¸°
                    for(let i=0; i<num; i++){
                        isrc.forEach(v=>{
                            document.querySelectorAll(".mybx")[seq]
                            .innerHTML +=
                            `<img class="timg" src="${v}" alt="test">`;
                        });
                    } ////////// for /////////////
                }; //////////////// addImg í•¨ìˆ˜ ///////////

                
                // ì´ë¯¸ì§€ ì»¨í…ì¸ ë¥¼ ë¡œë”©í•˜ëŠ” í•¨ìˆ˜ë¥¼ Promiseí•˜ì!
                // async / await ë¥¼ ì‚¬ìš©í•¨!
                // async functionì•ˆì— í”„ë¼ë¯¸ìŠ¤ì˜ ì„¸ê³„ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤!
                async function setIt(fn,seq){ 
                    // fn ì‹¤í–‰ì½”ë“œí•¨ìˆ˜, seq-ì ìš©ëŒ€ìƒìˆœë²ˆ
                    // ì¬ì‚¬ìš©ì„±ì„ ìœ„í•´ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ë°›ëŠ”ë‹¤!
                    let doit = new Promise(function(success){
                        // ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ì½”ë“œ
                        fn();
                        // addImg();

                        // ìœ„ì˜ ì½”ë“œê°€ ë‹¤ì‹¤í–‰ë˜ë©´ ì•„ë«ì½”ë“œë¥¼ í˜¸ì¶œí•¨!
                        success(seq);
                    }); /////////// doit í”„ë¼ë¯¸ìŠ¤ ////////

                    // í”„ë¼ë¯¸ìŠ¤ê°€ ë³´ì¥í•˜ëŠ” ì½”ë“œì‹¤í–‰í›„ ì‹¤í–‰í•¨ìˆ˜
                    const thenDoit = (seq) => { // seq - ì ìš©ìˆœë²ˆ
                        //seq - successì—ì„œ ì „ë‹¬í•œ ê°’ ë°›ê¸°
                        console.log("ì´ê²Œë­ì•¼?",seq);

                        // ë¡œë”©ë°”ë¥¼ ì—†ì•°! ğŸ˜€í•´ë‹¹ë˜ëŠ”ê²ƒë§Œ ë”°ë¡œë”°ë¡œí•´
                        document.querySelectorAll(".mybx")[seq]
                        .querySelector(".loading").remove();

                    }; ///////////// thenDoit í•¨ìˆ˜ ////////////

                    // í”„ë¼ë¯¸ìŠ¤ í˜¸ì¶œí•˜ê¸°(awaitì‚¬ìš©)
                    thenDoit(await doit);
                    // ì‹¤í–‰ìˆœì„œ
                    // await ë’¤ì— doit í•¨ìˆ˜ë¥¼ ë¨¼ì € í˜¸ì¶œ!
                    // doitì€ í”„ë¼ë¯¸ìŠ¤ ìƒì„±ìí•¨ìˆ˜ì„!
                    // doitì—ì„œ ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ì½”ë“œê°€ ëª¨ë‘ ëë‚˜ë©´
                    // success() ê°€ ì‹¤í–‰ë˜ê³  ê·¸ê²ƒì€ 
                    // thenDoit í•¨ìˆ˜ëŠ” successê°€ ë¦¬í„´í•´ì£¼ëŠ” ê°’ì„
                    // ë°›ì„ë•Œ ê¹Œì§€ ê¸°ë‹¤ë¦¼!

                } //////////// async í•¨ìˆ˜êµ¬ì—­ ////////////////


                // ë¨¼ì € ë¡œë”©í‘œì‹œ ì´ë¯¸ì§€ ë³´ì´ê¸° í•¨ìˆ˜ í˜¸ì¶œ! -> ìƒë‹¨ì—ì„œ ëª¨ë‘ ë„£ê¸°í•¨!
                // firstDo();
                // setIt();

                // async/await ëŠ” ë°˜ë“œì‹œ ë°”ê¹¥ì—ì„œ í˜¸ì¶œí•„ìˆ˜!
                // ì•½ê°„ì˜ ì‹œì°¨ë¥¼ ì¤Œ
                setTimeout(()=>{
                    // setIt(ì ìš©í•¨ìˆ˜,ìˆœë²ˆ)
                    // addImg(ë°˜ë³µíšŸìˆ˜,ìˆœë²ˆ)
                    setIt(addImg(200,0),0);
                    setIt(addImg(50,1),1);
                    setIt(addImg(100,2),2);
                },100);
                // ë¡œë”©ë°”ì™€ ì‹¤í–‰ì²˜ë¦¬êµ¬ì—­ì„ êµ¬ë¶„í•˜ì—¬
                // ë¡œë”©ë°” ì´ë¯¸ì§€ê°€ ì²˜ë¦¬ì´ë¯¸ì§€ì™€ ê°™ì´ ì²˜ë¦¬ë˜ì§€ ì•Šë„ë¡
                // ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ ë¡œë”©ë°”ê°€ ë³„ë„ë¡œ í™”ë©´ì— ë¨¼ì €
                // ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤!


                console.log("DOMë¡œë“œ");
            }); /////////// DOMContentLoaded /////////////

            console.log("JSì‹œì‘");
        </script>
    </head>
    <body>
        <!-- ê°œë³„ë°•ìŠ¤ -->
        <div class="mybx"></div>
        <div class="mybx"></div>
        <div class="mybx"></div>

    </body>
</html>