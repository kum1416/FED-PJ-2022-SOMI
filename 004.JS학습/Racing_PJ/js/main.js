// Racing PJ ë©”ì¸ JS - main.js

/// ìš”ì†Œì„ íƒí•¨ìˆ˜ /////
const qs = x => document.querySelector(x);
const qsa = x => document.querySelectorAll(x);
/// ë©”ì‹œì§€í•¨ìˆ˜ ////
const cg = x => console.log(x);

//////////////// ë¡œë“œêµ¬ì—­ /////////////////////////
window.addEventListener("DOMContentLoaded", ()=>{
    console.log("ë¡œë”©ì™„ë£Œ!");

    /************************************************** 
        [ ê²Œì„ ê¸°ëŠ¥ì •ì˜ ]
        1. ê²Œì„ë£°: ê±°ë¶ë²„íŠ¼ í´ë¦­í•˜ì—¬ ê±°ë¶ì„
            ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™í•¨
            ì´ë•Œ í† ë¼ëŠ” ìë™ìœ¼ë¡œ ì´ë™í•˜ì—¬
            ê²°ìŠ¹ì„ ì— ë¨¼ì € ë„ë‹¬í•˜ëŠ” ë ˆì´ì„œê°€ ìŠ¹ë¦¬í•¨
        2. í† ë¼ì˜ ì´ë™ì†ë„ëŠ” ë ˆë²¨ë¡œ ì„¤ì •í•¨
        3. ê²°ìŠ¹ì„  ë„ì°©ì€ ë‘˜ ì¤‘ í•˜ë‚˜ê°€ ë¨¼ì €
            ë„ì°©í•  ê²½ìš° íŒë³„í•¨ìˆ˜ì—ì„œ ê²°ê³¼ë¥¼
            í™”ë©´ì— ì¶œë ¥í•œë‹¤.
        4. í¬ì»¤ìŠ¤ê°€ ë²„íŠ¼ì— ê°ˆ ê²½ìš° ë§ˆìš°ìŠ¤ê°€
            ì•„ë‹Œ í‚¤ë³´ë“œ ë²„íŠ¼ìœ¼ë¡œ ì¡°ì‘í•  ìˆ˜ ì—†ê²Œí•¨
            (ë§ˆìš°ìŠ¤ë§Œ ì‚¬ìš©í•˜ë„ë¡ í•¨!)
        5. ê¸°ë³¸ì ìœ¼ë¡œ ê±°ë¶ì´ë™ë²„íŠ¼ í´ë¦­ì‹œ
             í† ë¼ëŠ” ìë™ìœ¼ë¡œ ì‘ë™ë¨!
        6. í† ë¼ì´ë™ë²„íŠ¼ì€ í† ë¼ë§Œ ë¯¸ë¦¬ ì‘ë™ê°€ëŠ¥
        7. ì²˜ìŒìœ¼ë¡œ ë²„íŠ¼ì€ ì „ì²´ë¥¼ ë¦¬ì…‹í•¨
    **************************************************/

    // 1. ëŒ€ìƒì„ ì • //////////
    // (1) ê±°ë¶ : #t1
    const t1 = qs("#t1");
    // (2) í† ë¼ : #r1
    const r1 = qs("#r1");
    // (3) ë²„íŠ¼ : #btns a
    const btns = qsa("#btns a");
    // (4) ë ˆë²¨ : #level
    const level = qs("#level");
    // (5) ë©”ì‹œì§€ë°•ìŠ¤ : #msg
    const msg = qs("#msg");
    // (6) í† ë¼, ê±°ë¶ˆ ìœ„ì¹˜ê°’ ë³€ìˆ˜
    let r1pos = 0, t1pos = 0;
    // í† ë¼ìœ„ì¹˜ : r1pos / ê±°ë¶ìœ„ì¹˜ : t1pos

    // cg(msg);
    
    // 2. ì´ë²¤íŠ¸ ì„¤ì •í•˜ê¸° ////////////
    // ëŒ€ìƒ: ë²„íŠ¼ë“¤ - btnsë³€ìˆ˜
    btns.forEach(ele=>{
        // 1.ì´ë²¤íŠ¸ ì„¤ì •
        ele.onclick = e => { //ğŸ“¢e->ì´ë²¤íŠ¸ê°€ ë‚´ë¶€ë¡œ ì „ë‹¬ëŒ
            // (0) ê¸°ë³¸ê¸°ëŠ¥ë§‰ê¸°
            e.preventDefault();
            // (1) ë²„íŠ¼ì¢…ë¥˜í™•ì¸ : ë²„íŠ¼í…ìŠ¤íŠ¸
            let btxt = ele.innerText;
            cg(btxt);

            // (2) ë²„íŠ¼ë³„ ê¸°ëŠ¥ë¶„ê¸°
            // (2-1) í† ë¼ì´ë™
            if(btxt==="í† ë¼ì¶œë°œ"){
                // í† ë¼ ìë™ì´ë™í•¨ìˆ˜ í˜¸ì¶œ!
                goR1();
                
            } ///// ifë¬¸ : í† ë¼ì¶œë°œ //////

                // ìœ„ì¹˜ì´ë™í•˜ê¸°
                // r1.style.left = (++r1pos) + "px"; //ğŸ“¢ë ˆí”„íŠ¸ê°’ì„ í”½ì…€ë¡œ ë³€ê²½ì‹œì¼œì£¼ê³  r1posë§Œí¼ ì¦ê°€


            // (2-2) ê±°ë¶ì´ë™
            else if(btxt==="ê±°ë¶ì¶œë°œ"){
                // ê±°ë¶ë©ˆì¶¤ ìƒíƒœê°’(t1Stop)ì´ 1ì´ë©´ ëŒì•„ê°€!
                if(t1Stop) return;

                // ìœ„ì¹˜ì´ë™ê°’ ì…‹íŒ…
                t1pos += 16;
                // ìœ„ì¹˜ì´ë™í•˜ê¸°
                t1.style.left = t1pos + "px"; 

                // í† ë¼ ìë™ì´ë™í•¨ìˆ˜ í˜¸ì¶œ!
                goR1();

            } ///// ifë¬¸ : ê±°ë¶ì¶œë°œ //////

            // (2-3) ì²˜ìŒìœ¼ë¡œ ë²„íŠ¼ í´ë¦­ì‹œ
            else if(btxt==="ì²˜ìŒìœ¼ë¡œ"){
                // ë¸Œë¼ìš°ì € ìºì‹±ì„ ì§€ìš°ê³  ë‹¤ì‹œë¶€ë¥´ê¸°
                // location.replace("index.html");

                // í˜„ì¬ í˜ì´ì§€ ë¦¬ë¡œë”©
                location.reload();
            } ///////// else ifë¬¸ : ì²˜ìŒìœ¼ë¡œ ////

        }; /////// click ////
    }); ////////// forEach /////// ğŸ“¢forEachëŠ” ë©”ì„œë“œ




    /********************************************* 
            í•¨ìˆ˜ëª…: goR1
            ê¸°ëŠ¥: í† ë¼ìë™ì´ë™(ì¸í„°ë°œí•¨ìˆ˜)
    *********************************************/
   let autoI; // ì¸í„°ë°œìš©ë³€ìˆ˜
    function goR1(){
        // í• ë‹¹ì•ˆëœë³€ìˆ˜ê°’ì€ undefinedì´ê³ 
        // ifë¬¸ì—ì„œ falseì²˜ë¦¬ë˜ë¯€ë¡œ
        // í• ë‹¹ì „ ìƒíƒœì¼ë•Œë§Œ ifë¬¸ì— ë“¤ì–´ê°€ê²Œ
        // í•˜ê¸° ìœ„í•´ !(NOTì—°ì‚°ì)ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤!

        // cg(autoI);
        // cg(level.value);

        if(!autoI){ /// í• ë‹¹ì „ì— 1ë²ˆë§Œ í—ˆìš©!
            autoI = setInterval(() => {
                // í† ë¼ ìœ„ì¹˜ì´ë™
                r1.style.left = (++r1pos) + "px";

                // í† ë¼&ê±°ë¶ ìœ„ì¹˜ê°’ì²´í¬ í›„ ìŠ¹ìíŒë³„ í•¨ìˆ˜í˜¸ì¶œ
                whoWinner();

            }, level.value);
            // ì¸í„°ë°œ ì‹œê°„ì€ ì„ íƒë°•ìŠ¤ì˜
            // ì˜µì…˜ê°’ì„ ì½ì–´ì„œ ì‚¬ìš©í•œë‹¤! -> level.value
            // ì˜µì…˜ê°’ë“¤ : 10,9,8,7,6,5,4
    } //////////////// if ////////////

    } ////////////// goR1 í•¨ìˆ˜ ///////////////

    //ğŸ“¢í•¨ìˆ˜ë§Œë“¤ê¸°
    /********************************************* 
        í•¨ìˆ˜ëª…: whoWinner
        ê¸°ëŠ¥: ê¸°ì¤€ê°’ ë³´ë‹¤ ë ˆì´ì„œìœ„ì¹˜ê°’ì´ í° ê²½ìš°
            ìŠ¹ìë¥¼ íŒë³„í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤!
    *********************************************/
   let t1Stop = 0; // ê±°ë¶ë©ˆì¶¤ê°’(1ë©ˆì¶¤,0í—ˆìš©)
   function whoWinner(){
    // cg("í† ë¼:"+r1pos);
    // cg("ê±°ë¶:"+t1pos);

    // 1. í† ë¼ / ê±°ë¶ì˜ ìœ„ì¹˜ê°’ì´ ê¸°ì¤€ê°’ ì´ìƒì¼ë•Œ
    // ê¸°ì¤€ê°’: 650px
    if(r1pos >= 650 || t1pos >= 650){

        // (1) í† ë¼ì•¼ ë©ˆì¶°ë¼! -> ì¸í„°ë°œí•¨ìˆ˜ì§€ìš°ê¸°!
        clearInterval(autoI);

        // (2) ê±°ë¶ì•„ ë©ˆì¶°ë¼! -> ê±°ë¶ë©ˆì¶¤ìƒíƒœê°’ 1ë¡œ ë³€ê²½!
        t1Stop = 1;

        // (3) ìŠ¹ìíŒë³„ í›„ ë©”ì‹œì§€ ë³´ì—¬ì£¼ê¸°!
        if(r1pos > t1pos) msg.innerText = "í† ë¼ìŠ¹!"
        if(r1pos < t1pos) msg.innerText = "ê±°ë¶ìŠ¹!"
        else msg.innerText = "ë¹„ê¹€!ì¬ìŠ¹ë¶€!"



    } //////////////// if ///////////////

   } //////////// whoWinner í•¨ìˆ˜ //////////






}); /////////// ë¡œë“œêµ¬ì—­ ///////////////////////////
