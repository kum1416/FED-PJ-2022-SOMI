// ì œì´ì¿¼ë¦¬ë¡œ êµ¬í˜„í•œ ìë™í˜ì´ì§€ íœ  JS : jquery-autoScroll.js

// ë¡œë”©êµ¬ì—­ì—†ì´ í•¨ìˆ˜ë¡œ êµ¬í˜„í•¨! /////

// ì „ì²´ë¥¼ í•¨ìˆ˜ë¡œ ë¬¶ì–´ì¤€ë‹¤! ///////
// ì´ìœ : export í•˜ê¸°ìœ„í•´!

function autoScroll() {
  // í˜„ì¬ í˜ì´ì§€ ê°€ë¡œí¬ê¸°ê¸°ì¤€ 800pxì´í•˜ì¼ë•Œ ëª¨ë°”ì¼ë¡œ ë³€ê²½
  // ëª¨ë°”ì¼ ìƒíƒœë³€ìˆ˜
  let mob = 0; // 1-ëª¨ë°”ì¼/0-DT
  const upDateW = () => {
    // autoScroll ë“¤ì–´ì˜¤ìë§ˆì ë§Œë“¬!
    if ($(window).width() <= 800) mob = 1;
    else mob = 0;
    console.log("mob:", mob);
  }; ///////////// upDateW í•¨ìˆ˜ ////////////

  // ë¡œë”©ì‹œ ì‹¤í–‰!
  upDateW();

  // ë°°ë„ˆì´ˆê¸°í™” ì ìš©í•¨ìˆ˜
  const callInit = () => {
    if (!mob) {
      // ëª¨ë°”ì¼ì•„ë‹ˆë©´ ì´ˆê¸°í™”
      initSet();
      // ì¤‘ê°„í˜ì´ì§€ì¼ ê²½ìš° ì´ˆê¸°í™” ì œì™¸(ì§€ìš°ê¸°)
      $(".page").eq(pno)
      .find(".imgc,.txtc a").attr("style", ""); // ğŸ˜€ì´ê±° ì™œí•˜ë”ë¼

    } // ëª¨ë°”ì¼ì´ë©´ ì´ˆê¸°í™” ì…‹íŒ…ì§€ìš°ê¸°
    else $(".imgc,.txtc a").attr("style", ""); // ìŠ¤íƒ€ì¼ì‹œíŠ¸ë¥¼ ë¹„ì›Œ!
  }; //////// callInit í•¨ìˆ˜ ///////

  // window ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸ë“±ë¡ ğŸ˜€ì´ê±° ì™œí•˜ë”ë¼
  $(window).resize(() => {
    // ì—¬ëŸ¬ê°œ í˜¸ì¶œí• ë•Œ
    upDateW(); // mobì½”ë“œ ì—…ë°ì´íŠ¸í•¨ìˆ˜
    callInit(); // ë°°ë„ˆì´ˆê¸°í™” ì ìš©í•¨ìˆ˜
  });

  /****************************************** 
        ëŒ€ìƒ ë³€ìˆ˜í• ë‹¹í•˜ê¸°
    ******************************************/
  // ì „ì²´ í˜ì´ì§€ë²ˆí˜¸
  let pno = 0;
  // í˜ì´ì§€ ìš”ì†Œ
  const pg = $(".page");
  // ì „ì²´ í˜ì´ì§€ê°œìˆ˜
  const pgcnt = pg.length;
  // console.log("í˜ì´ì§€ê°œìˆ˜:", pgcnt, pg);
  // ê´‘ì‹¤í–‰ê¸ˆì§€ë³€ìˆ˜
  let prot = [];
  // ê´‘ìŠ¤í¬ë¡¤ê¸ˆì§€
  prot[0] = 0;
  // GNB ë©”ë‰´ li
  const gnb = $(".gnb li");
  // indic ë©”ë‰´ li
  const indic = $(".indic li");
  // ê° í˜ì´ì§€ë³„ ë“±ì¥ìš”ì†Œ
  const minfo = $(".minfo");

  /****************************************** 
        ì´ë²¤íŠ¸ ë“±ë¡í•˜ê¸°
    ******************************************/
  // ìœˆë„ìš° íœ ì´ë²¤íŠ¸ ë°œìƒì‹œ
  $(window).on("wheel", wheelFn);
  // GNBë©”ë‰´ í´ë¦­ì‹œ : ëŒ€ìƒ - .gnb a
  $(".gnb a").click(chgMenu);
  // ì¸ë””ì¼€ì´í„° í´ë¦­ì‹œ : ëŒ€ìƒ - .indic a
  $(".indic a").click(chgMenu);

  // ìƒˆë¡œê³ ì¹¨ì‹œ ìŠ¤í¬ë¡¤ìœ„ì¹˜ ìºì‹± ë³€ê²½í•˜ê¸°(ë§¨ìœ„ë¡œ!)
  $("html,body").animate({ scrollTop: "0px" });

  /**************************************** 
        í•¨ìˆ˜ëª…: wheelFn
        ê¸°ëŠ¥: ë§ˆìš°ìŠ¤íœ  ì´ë²¤íŠ¸ ë°œìƒì‹œ í˜¸ì¶œë¨
        -> í•œí˜ì´ì§€ì”© ìë™ìŠ¤í¬ë¡¤ ê¸°ëŠ¥
    ****************************************/
  function wheelFn() {
    // ëª¨ë°”ì¼ì¼ë•Œ ì‘ë™ì •ì§€
    if (mob) return; // ë°‘ì— ì½”ë“œëŠ” ì‹¤í–‰ì´ì•ˆëŒ

    // ê´‘íœ ê¸ˆì§€
    if (prot[0]) return;
    chkCrazy(0);

    console.log("íœ ~~~~~~!");

    // 1.íœ ë°©í–¥ ì•Œì•„ë‚´ê¸°
    let delta = event.wheelDelta;
    console.log(delta);

    // 2. ë°©í–¥ì— ë”°ë¥¸ í˜ì´ì§€ë²ˆí˜¸ ì¦ê°
    if (delta < 0) {
      pno++;
      if (pno === pgcnt) pno = pgcnt - 1;
      // ë§ˆì§€ë§‰ í˜ì´ì§€ë²ˆí˜¸ì— ê³ ì •!
    } //// if /////
    else {
      pno--;
      if (pno === -1) pno = 0;
      // ì²«í˜ì´ì§€ë²ˆí˜¸ì— ê³ ì •!
    } //// else ////

    console.log(pno);

    // 3. ìŠ¤í¬ë¡¤ ì´ë™í•˜ê¸° + ë©”ë‰´ì— í´ë˜ìŠ¤"on"ë„£ê¸°
    movePg();
  } /////////////// wheelFn í•¨ìˆ˜ ///////////////

  // ê´‘í´ ì´ˆê¸°ê°’
  prot[1] = 0;
  /******************************************** 
        í•¨ìˆ˜ëª…: chgMenu
        ê¸°ëŠ¥: ë©”ë‰´ í´ë¦­ì‹œ ë©”ë‰´ë³€ê²½ê³¼ í˜ì´ì§€ì´ë™
    ********************************************/
  function chgMenu() {
    // 0. ê´‘í´ê¸ˆì§€
    if (prot[1]) return;
    chkCrazy(1);

    // 1. í´ë¦­ëœ aìš”ì†Œì˜ ë¶€ëª¨ li ìˆœë²ˆì„ êµ¬í•¨ === pno
    let idx = $(this).parent().index();

    console.log("ë‚˜,í´ë¦­?", this, idx);

    // 2. ì „ì—­í˜ì´ì§€ë²ˆí˜¸ì— ìˆœë²ˆ ì—…ë°ì´íŠ¸
    pno = idx;

    // 3. í˜ì´ì§€ì´ë™ + ë©”ë‰´ì— í´ë˜ìŠ¤"on"ë„£ê¸°
    movePg();
  } ////////// chgMenu í•¨ìˆ˜ ///////////////////

  /******************************************** 
        í•¨ìˆ˜ëª…: chkCrazy
        ê¸°ëŠ¥: ê´‘ì ë™ì‘ ì²´í¬í•˜ì—¬ ì œì–´ë¦¬í„´
    ********************************************/
  function chkCrazy(seq) {
    // seq ê´€ë¦¬ë³€ìˆ˜ ìˆœë²ˆ
    prot[seq] = 1;
    setTimeout(() => (prot[seq] = 0), 800);
  } //////// chkCrazyí•¨ìˆ˜ //////////////

  /******************************************** 
        í•¨ìˆ˜ëª…: movePg
        ê¸°ëŠ¥: í˜ì´ì§€ì´ë™ ì• ë‹ˆë©”ì´ì…˜
    ********************************************/
  function movePg() {
    // ëŒ€ìƒ: html,body -> ë‘ê°œë¥¼ ëª¨ë‘ ì¡ì•„ì•¼ ê³µí†µì ìœ¼ë¡œ ì ìš©ë¨!
    $("html,body").animate(
      {
        scrollTop: $(window).height() * pno + "px",
      },
      700,
      "easeInOutQuint",
      actPage // ì´ë™í›„ ì½œë°±í•¨ìˆ˜í˜¸ì¶œ!
    );

    // ëŒ€ìƒ: GNBë©”ë‰´ , ì¸ë””ì¼€ì´í„° ë©”ë‰´
    gnb.eq(pno).addClass("on").siblings().removeClass("on");
    indic.eq(pno).addClass("on").siblings().removeClass("on");
  } ///////////////// movePg ////////////////

  /******************************************** 
        [ í˜ì´ì§€ ë“±ì¥ì•¡ì…˜ ìš”ì†Œ ì ìš©í•˜ê¸° ]
        1. ì´ë²¤íŠ¸ ì ìš©ì‹œì  : í˜ì´ì§€ë„ì°©í›„(ì• ë‹ˆí›„ì½œë°±) 
        2. ì´ë²¤íŠ¸ ëŒ€ìƒ : ê° í˜ì´ì§€ ë™ì¼
            (1) .page .imgc - ì´ë¯¸ì§€íŒŒíŠ¸
            (2) .page .txtc h2 a - íƒ€ì´í‹€íŒŒíŠ¸
        3. ë³€ê²½ë‚´ìš© :
            [ìŠ¤íƒ€ì¼ì‹œíŠ¸ ì•„ë˜ í•­ëª© ë³€ê²½]
            ((ë³€ê²½ê°’))
            transform: rotate(45deg);
            opacity: 0;
            transition: 1s 1s; -> íƒ€ì´í‹€ë§Œ ì§€ì—°ì‹œê°„
            ((ê³ ì •ê°’))
            transform-origin: left top;
            display: inline-block; -> aìš”ì†Œë§Œ
    ********************************************/

  /******************************************* 
        í•¨ìˆ˜ëª…: initSet
        ê¸°ëŠ¥: ë“±ì¥ìš”ì†Œ ì²˜ìŒìƒíƒœ ì…‹íŒ…
    *******************************************/
  function initSet() {
    // 1. ì´ˆê¸°í™”í•˜ê¸° ///////////
    // ëŒ€ìƒ: .imgc
    $(".imgc").css({
      transform: "rotate(45deg)",
      transformOrigin: "-10% -10%",
      opacity: "0",
      transition: "1s ease-in-out",
    }); /////////// css ///////////

    // ëŒ€ìƒ: .txtc a
    $(".txtc a").css({
      transform: "rotate(45deg)",
      transformOrigin: "-100% -100%",
      opacity: "0",
      transition: "1s ease-in-out .5s",
      display: "inline-block",
    }); /////////// css ///////////
  } ////////////// initSet í•¨ìˆ˜ //////////////

  // ì´ˆê¸°í™”í•¨ìˆ˜ í˜¸ì¶œ -> ëª¨ë°”ì¼ì´ ì•„ë‹ë•Œë§Œ í˜¸ì¶œ!
  if (!mob) initSet(); // ì•„ë‹ë•Œê°€trueë‚˜ë©´ initSetì„ í˜¸ì¶œì‹œì¼œ

  /**************************************** 
        í•¨ìˆ˜ëª…: actPage
        ê¸°ëŠ¥ : í˜ì´ì§€ ë„ì°©í›„ ë“±ì¥ì• ë‹ˆë©”ì´ì…˜
    ****************************************/
  function actPage() {
    // ì´ë™í›„ í™•ì¸
    console.log("ì•¡ìˆ€~!!", pno);

    // pnoê°€ 0 ë˜ëŠ” 4ê°€ ì•„ë‹ˆë©´ ì•¡ì…˜ì‘ë™!
    if (pno !== 0 || pno !== 4) {
      // ëŒ€ìƒ: í•´ë‹¹ìˆœë²ˆì˜ .page ì•„ë˜ .imgc ì™€ .txtc a
      $(`.page:eq(${pno}) .imgc,
            .page:eq(${pno}) .txtc a`).css({
        transform: "rotate(0deg)",
        opacity: "1",
      }); /////////// css ///////////
    } ////////// if ///////////////////

    // ì²«í˜ì´ì§€ ì¼ë•Œ ì´ˆê¸°í™”!
    if (pno === 0) initSet();
  } ///////////// actPage í•¨ìˆ˜ ////////////
} //////////// autoScroll /////////////////

// ì „ì²´í•¨ìˆ˜ ë‚´ë³´ë‚´ê¸° ///////
export default autoScroll;
